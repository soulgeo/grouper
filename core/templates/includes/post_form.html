{% load static %}
{% load widget_tweaks %}

<div class="flex flex-row gap-4 p-4 bg-base-200 rounded-lg drop-shadow-sm">
    <div class="btn btn-ghost btn-circle avatar flex-none" name="profile-pic">
        <div class="w-16 rounded-full overflow-hidden">
            <a href="/p/{{ user.username }}"><img class="w-full h-full object-cover"
                src="{{ user.profile.image_url }}" alt="{{ user.username }}"></a>
        </div>
    </div>
    <div class="flex flex-col w-full">
        <form hx-post="{% url 'submit_post' %}" hx-target="#posts-body" hx-swap="afterbegin"
            hx-on::after-request="this.reset()">
            {% csrf_token %}
            <div class="flex flex-row gap-4">
                <div class="flex flex-col w-full gap-4 form-control">
                    <div class="font-bold form-control w-full">
                        {% render_field post_form.title placeholder="Title..." class="input input-bordered"%}
                    </div>
                    {% render_field post_content_form.text placeholder="Share something..." class="textarea textarea-bordered h-48" %}
                    {% render_field post_form.visibility class="select select-bordered w-32 max-w-xs" %}
                </div>
                <div class="form-control">
                    <div class="w-56 h-64 border border-base-content/20 rounded-lg overflow-y-auto bg-base-100">
                        {% for category in interest_categories %}
                        <div class="mb-4">
                            <h3 class="font-bold text-lg sticky top-0 bg-base-100 z-10 py-2 px-4">{{ category.name }}</h3>
                            <div class="flex flex-col gap-2 px-4">
                                {% for interest in category.interests.all %}
                                <label class="label cursor-pointer justify-start gap-2 py-0">
                                    <input type="checkbox" name="interests" value="{{ interest.id }}" class="checkbox checkbox-sm" {% if interest.id in selected_interests %}checked{% endif %} />
                                    <span class="label-text">{{ interest.name }}</span>
                                </label>
                                {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <button type="submit" class="btn btn-primary mt-4">Create Post</button>
        </form>
    </div>
</div>
